#!/usr/bin/env python3

"""Filter out the stations in Beijing, by lookup."""
import glob
bjs = [['北京', '54398', '顺义', '4008', '11637', '29.6', '28.6'],
       ['北京', '54399', '海淀', '3959', '11617', '46.9', '45.8'],
       ['北京', '54406', '延庆', '4027', '11558', '489.1', '487.9'],
       ['北京', '54416', '密云', '4023', '11652', '73.0', '71.8'],
       ['北京', '54419', '怀柔', '4022', '11638', '76.8', '75.7'],
       ['北京', '54421', '密云上甸子', '4039', '11707', '294.3', '293.3'],
       ['北京', '54424', '平谷', '4010', '11707', '33.3', '32.1'],
       ['北京', '54431', '通州', '3955', '11638', '44.5', '43.3'],
       ['北京', '54433', '朝阳', '3957', '11630', '36.3', '35.3'],
       ['北京', '54499', '昌平', '4013', '11613', '77.4', '76.2'],
       ['北京', '54501', '斋堂', '3958', '11541', '441.3', '440.3'],
       ['北京', '54505', '门头沟', '3956', '11606', '99.1', '98.0'],
       ['北京', '54511', '北京', '3948', '11628', '32.5', '31.3'],
       ['北京', '54513', '石景山', '3957', '11612', '66.8', '65.6'],
       ['北京', '54514', '丰台', '3952', '11615', '56.7', '55.2'],
       ['北京', '54594', '大兴', '3943', '11621', '38.8', '37.6'],
       ['北京', '54596', '房山', '3946', '11612', '49.9', '48.9'],
       ['北京', '54597', '霞云岭', '3944', '11544', '408.7', '407.7']]

# Load all station IDs in Beijing, uniquified by Python set
bj_ids = {s[1]+'0' for s in bjs}

# Load all station IDs in this database, uniquified by Python set
stations_have = {i.split('/')[1].split('-')[0]
                 for i in glob.glob("china_isd_lite_201*/*")}

print(bj_ids & stations_have)
